# Домашнее задание к занятию «Уязвимости и атаки на информационные системы» — Ривера Александр Андреевич

### Задание 1

При первичном сканировании Metasploitable с помощью `nmap -A -sV <ip>` были обнаружены следующие сетевые службы:

- **FTP** — vsftpd 2.3.4 (TCP/21)
- **SSH** — OpenSSH 4.7p1 Debian 8ubuntu1 (TCP/22)
- **Telnet** — Linux telnetd (TCP/23)
- **SMTP** — Postfix smtpd (TCP/25)
- **DNS** — ISC BIND 9.4.2 (TCP/53)
- **HTTP** — Apache httpd 2.2.8 (TCP/80)
- **RPC** — RPCbind и NFS-сервисы (TCP/111, TCP/2049)
- **Samba** — Samba smbd 3.0.20 (TCP/139, TCP/445)
- **MySQL** — MySQL 5.0.51a-3ubuntu5 (TCP/3306)
- **PostgreSQL** — PostgreSQL 8.3.0 (TCP/5432)
- **VNC** — VNC protocol 3.3 (TCP/5900)
- **RMIRegistry/JMX** — Java RMI Registry (TCP/1099) и Apache JServ Protocol (TCP/8009)
- **Tomcat** — Apache Tomcat/Coyote JSP engine 1.1 (TCP/8180)

В процессе анализа были найдены следующие уязвимости и соответствующие им эксплуатации:

1. **vsftpd 2.3.4 Backdoor Command Execution** — https://www.exploit-db.com/exploits/49757
2. **Samba 3.0.20 <= Remote Code Execution (CVE-2007-2447)** — https://www.exploit-db.com/exploits/16320
3. **Tomcat 6.0.20/7.0.0 Remote Code Execution via Manager App** — https://www.exploit-db.com/exploits/47230

Эти уязвимости выбирались по версиям сервисов, опубликованным в отчёте Nmap, и проверялись по базе exploit-db.

### Задание 2

Для демонстрации разных типов сканирования были выполнены последовательные запуски:

- `nmap -sS <ip>` — полуоткрытое SYN-сканирование
- `nmap -sF <ip>` — FIN-сканирование
- `nmap -sX <ip>` — Xmas-сканирование
- `nmap -sU <ip>` — UDP-сканирование

Каждый запуск фиксировался в Wireshark с фильтром по IP-адресу Metasploitable. Отличия режимов на уровне сетевого трафика:

- **SYN-сканирование** посылает только стартовые пакеты TCP SYN. При открытом порте цель отвечает SYN/ACK, после чего сканер посылает RST, не устанавливая полное соединение. На закрытых портах приходит RST.
- **FIN-сканирование** использует одиночные TCP FIN-пакеты. RFC предполагает игнорирование FIN на закрытых портах, но в реализации Linux Metasploitable закрытый порт отвечает RST. Открытый порт не отвечает вовсе, что фиксируется как «open|filtered».
- **Xmas-сканирование** отправляет TCP-пакет с установленными флагами FIN, PSH, URG. Ответы аналогичны FIN-скану: RST для закрытых портов и отсутствие ответа для потенциально открытых.
- **UDP-сканирование** передаёт пустые UDP-датаграммы. Открытые UDP-порты обычно не отвечают, а закрытые возвращают ICMP Port Unreachable. На Metasploitable часть портов помечена как «open|filtered», поскольку нет ответа из-за фильтрации или открытого сервиса.

Поведение сервера в захваченных трассировках:

- Для TCP-режимов видно, что Metasploitable последовательно отвечает на SYN/ACK или RST в зависимости от состояния порта, что подтверждает доступность большинства сервисов без применения фильтрации.
- На UDP-скане заметны ICMP ответы «Destination Unreachable (Port Unreachable)» от закрытых портов, в то время как активные службы (например, DNS на 53/udp) не отправляют ответ, что Nmap интерпретирует как «open|filtered».

Эти наблюдения позволяют понять, какие типы сканирования лучше подходят для скрытной проверки целей и какие ответы от сервера ожидать в каждом случае.
